test_cases:
  regular:
  - id: ru
    txt: Testing unsigned image...
    type: deploy
    ref: securesystemsengineering/testimage:unsigned
    namespace: default
    msg: Unable to find signed digest for image docker.io/securesystemsengineering/testimage:unsigned.
    validity: INVALID
  - id: rsdk
    txt: Testing image signed under different key...
    type: deploy
    ref: library/redis
    namespace: default
    msg: Failed to verify signature of trust data root.
    validity: INVALID
  - id: rs
    txt: Testing signed image...
    type: deploy
    ref: securesystemsengineering/testimage:signed
    namespace: default
    msg: pod/pod-rs created
    validity: VALID
  - id: rsds
    txt: Testing signed image with designated signer...
    type: deploy
    ref: securesystemsengineering/testimage:special_sig
    namespace: default
    msg: pod/pod-rsds created
    validity: VALID
  - id: rsmds
    txt: Testing image with missing designated signer...
    type: deploy
    ref: securesystemsengineering/testimage:wrong_signer
    namespace: default
    msg: Not all required delegations have trust data for image docker.io/securesystemsengineering/testimage:wrong_signer.
    validity: INVALID
  - id: rsdds
    txt: Testing image with differing designated signers...
    type: deploy
    ref: securesystemsengineering/testimage:double_sig
    namespace: default
    msg: Found multiple signed digests for image docker.io/securesystemsengineering/testimage:double_sig.
    validity: INVALID
  - id: rdvivs
    txt: Testing deployment of valid init container along with a valid container...
    type: apply
    ref: tests/integration/valid_init_container.yaml
    namespace: default
    msg: pod/connaisseur-integration-test-pod-valid-init created
    validity: VALID
  cosign:
  - id: cu
    txt: Testing unsigned cosign image...
    type: deploy
    ref: securesystemsengineering/testimage:co-unsigned
    namespace: default
    msg: No trust data for image "docker.io/securesystemsengineering/testimage:co-unsigned".
    validity: null
  - id: csdk
    txt: Testing cosign image signed under different key...
    type: deploy
    ref: securesystemsengineering/testimage:co-signed-alt
    namespace: default
    msg: Failed to verify signature of trust data.
    validity: null
  - id: cs
    txt: Testing signed cosign image...
    type: deploy
    ref: securesystemsengineering/testimage:co-signed
    namespace: default
    msg: pod/pod-cs created
    validity: null
  ignore-namespace-val:
  - id: iuu
    txt: Testing unsigned image in unlabelled namespace...
    type: deploy
    ref: securesystemsengineering/testimage:unsigned
    namespace: default
    msg: Unable to find signed digest for image docker.io/securesystemsengineering/testimage:unsigned.
    validity: null
  - id: isu
    txt: Testing signed image in unlabelled namespace...
    type: deploy
    ref: securesystemsengineering/testimage:signed
    namespace: default
    msg: pod/pod-isu created
    validity: null
  - id: iui
    txt: Testing unsigned image in ignored namespace...
    type: deploy
    ref: securesystemsengineering/testimage:unsigned
    namespace: ignoredns
    msg: pod/pod-iui created
    validity: null
  validate-namespace-val:
  - id: vue
    txt: Testing unsigned image in enabled namespace...
    type: deploy
    ref: securesystemsengineering/testimage:unsigned
    namespace: validatedns
    msg: Unable to find signed digest for image docker.io/securesystemsengineering/testimage:unsigned.
    validity: null
  - id: vse
    txt: Testing signed image in enabled namespace...
    type: deploy
    ref: securesystemsengineering/testimage:signed
    namespace: validatedns
    msg: pod/pod-vse created
    validity: null
  - id: vuu
    txt: Testing unsigned image in unlabelled namespace...
    type: deploy
    ref: securesystemsengineering/testimage:unsigned
    namespace: default
    msg: pod/pod-vuu created
    validity: null
  deployment:
  - id: d1s
    txt: Testing 1 signed image deployment...
    type: apply
    ref: tests/integration/deployments/deployment_i1.yaml
    namespace: default
    msg: deployment.apps/i1-deployment created
    validity: null
  - id: d1u
    txt: Testing 1 unsigned image deployment...
    type: apply
    ref: tests/integration/deployments/deployment_i1u1.yaml
    namespace: default
    msg: "denied the request: Unable to find signed digest"
    validity: null
  - id: d1nc
    txt: Testing 1 nonexistent image (cosign) deployment...
    type: apply
    ref: tests/integration/deployments/deployment_i1n1.yaml
    namespace: default
    msg: MANIFEST_UNKNOWN
    validity: null
  - id: d2s
    txt: Testing 2 signed images deployment...
    type: apply
    ref: tests/integration/deployments/deployment_i2.yaml
    namespace: default
    msg: deployment.apps/i2-deployment created
    validity: null
  - id: d1sf1us
    txt: Testing 1 signed image (first) and 1 unsigned (second) image deployment...
    type: apply
    ref: tests/integration/deployments/deployment_i2u1-2.yaml
    namespace: default
    msg: "denied the request: Unable to find signed digest"
    validity: null
  - id: d1ss1uf
    txt: Testing 1 signed image (second) and 1 unsigned (first) image deployment...
    type: apply
    ref: tests/integration/deployments/deployment_i2u1-1.yaml
    namespace: default
    msg: "denied the request: No trust data"
    validity: null
  - id: d2u
    txt: Testing 2 unsigned images deployment...
    type: apply
    ref: tests/integration/deployments/deployment_i2u2.yaml
    namespace: default
    msg: "denied the request:"
    validity: null
  - id: d2s1si
    txt: Testing 2 signed images and 1 signed init container deployment...
    type: apply
    ref: tests/integration/deployments/deployment_i2i.yaml
    namespace: default
    msg: deployment.apps/i2i-deployment created
    validity: null
  - id: d2s1ui
    txt: Testing 2 signed images and 1 unsigned init container deployment...
    type: apply
    ref: tests/integration/deployments/deployment_i2ui.yaml
    namespace: default
    msg: "denied the request: Unable to find signed digest for image"
    validity: null
